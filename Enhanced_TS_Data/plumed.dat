# vim:ft=plumed
LOAD FILE=TD_TS-target-plumed2.6.cpp
UNITS NATURAL
p: POSITION ATOM=1
ene: ENERGY
bf1: BF_LEGENDRE MINIMUM=-3 MAXIMUM=+3 ORDER=14 SCALED 

TD_TS_TARGET ...
  SCALEFACTOR=30
  LAMBDA=0.05    
  LIMIT=0.1
  PRINT_STRIDE=500
  LABEL=td
... TD_TS_TARGET

VES_LINEAR_EXPANSION ...
  ARG=p.x
  BASIS_FUNCTIONS=bf1
  LABEL=b1
  TEMP=1.0
  GRID_BINS=300
  TARGET_DISTRIBUTION=td
... VES_LINEAR_EXPANSION

OPT_AVERAGED_SGD ...
  BIAS=b1
  STRIDE=500
  LABEL=o1
  STEPSIZE=1
  FES_OUTPUT=100
  COEFFS_OUTPUT=100
  TARGETDIST_OUTPUT=500
  TARGETDIST_STRIDE=500
  MONITOR_AVERAGE_GRADIENT
... OPT_AVERAGED_SGD

PRINT ARG=* STRIDE=100 FILE=colvar.data FMT=%8.4f
